SELECT C.CAR_ID, C.CAR_TYPE, TRUNCATE((C.daily_fee * 30 * (100 - D.DISCOUNT_RATE) / 100),0) AS FEE FROM CAR_RENTAL_COMPANY_CAR C
JOIN CAR_RENTAL_COMPANY_DISCOUNT_PLAN D
ON C.CAR_TYPE = D.CAR_TYPE
WHERE (DURATION_TYPE = "30일 이상") AND C.CAR_ID NOT IN 
(SELECT CAR_ID FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY
WHERE DATEDIFF(START_DATE, DATE("2022-11-30")) <= 0 AND ((DATEDIFF(END_DATE, DATE("2022-11-01")) >= 0)))
AND C.CAR_TYPE IN ("세단", "SUV") AND TRUNCATE((C.daily_fee * 30 * (100 - D.DISCOUNT_RATE) / 100),0) >= 500000 AND TRUNCATE((C.daily_fee * 30 * (100 - D.DISCOUNT_RATE) / 100),0) < 2000000
ORDER BY FEE DESC, CAR_TYPE, CAR_ID DESC



-- 이용 가능한 자동차 아이디



-- 금액 : 50만원 이상 200만원 미만
-- order by 대여 금액 DESC, 자동차 종류, 자동차 id DESC


-- 자동차 종류 = 세단, SUV
-- 2022-11-01~2022-11-30 대여 가능
-- end_Date가 11-01 보다 빠르거나 start_date가 11-30보다 늦는 경우